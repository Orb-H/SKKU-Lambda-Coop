<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>SKKoin Administration Page</title>
  <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>

  <!-- update the version number as needed -->
  <script src="/__/firebase/6.2.4/firebase-app.js"></script>
  <!-- include only the Firebase features as you need -->
  <script src="/__/firebase/6.2.4/firebase-auth.js"></script>
  <script src="/__/firebase/6.2.4/firebase-database.js"></script>
  <script src="/__/firebase/6.2.4/firebase-storage.js"></script>
  <!-- initialize the SDK after all desired features are loaded -->
  <script src="/__/firebase/init.js"></script>

  <script type="text/javascript">
    init();

    function lookUpItems() {
      var database = firebase.database();
      /*database.ref('/gifticons')
       */
      //Load all gifticons
      //Load #gifticons
      //Configure #gifticons
    }

    function detailLookUpItems() {
      var database = firebase.database();
      /*
      database.ref('');
      */
      document.getElementById("detailgift").innerHTML = `
      <table>
      </table>
      `;
    }

    function addItem(input) {
      if (input.files && input.files[0]) {
        document.getElementById("images").innerHTML = "";
        for (i = 0; i < input.files.length; i++) {
          var reader = new FileReader();

          reader.onload = function(e) {
            document.getElementById("images").innerHTML += ("<p><img src=" + e.target.result + " width=150 /></p>");
          };

          reader.readAsDataURL(input.files[i]);
        }
      }
    }

    function sendItem() {
      var database = firebase.database();
      var type = document.getElementById("gifttype");
      var name = document.getElementById("giftname");
      var input = document.getElementById("files");
      if (input.files && input.files[0]) {
        for (i = 0; i < input.files.length; i++) {
          var reader = new FileReader();
          var image = reader.readAsDataURL(input.files[i]);

          //database.ref('');
        }
      }
    }

    function editItem() {
      var database = firebase.database();
      /*database.ref('/gifticons/'+itemID).update({
//Update if needed
    })
      */
    }

    function removeItem() {
      var database = firebase.database();
      //database.ref('/gitficons/'+itemID).remove();
    }

    function init() {
      if (!!firebase.auth().currentUser) {
        console.log("exist");
        loadGifticonContent();
      }
      firebase.auth().onAuthStateChanged(function(user) {
        if (user) {
          console.log("re-authed");
          loadGifticonContent();
        } else {
          console.log("unauth");
          location.href = "/";
          alert('Login first!!!');
        }
      });
    }

    function loadGifticonContent() {
      $("#loadGifticon").prop('disabled', true).toggleClass("disabled");
      $("#loadUser").prop('disabled', false).toggleClass("disabled");
      $("div").html(`
        <ul>
        <li>
        <a href="#lookup">기프티콘 조회</a>
        </li>
        <li>
        <a href="#add">기프티콘 추가</a>
        </li>
        </ul>
        <hr/>
        <p id="lookup">
        <h2>기프티콘 목록</h2>
        <p>
        <button id="giftlookup">조회</button>
        </p>
        <table border=0 cellspacing=0 id=\"gifticons\">
        <thead>
        <tr>
        <td>Type</td>
        <td>이름</td>
        <td>가격</td>
        <td>재고</td>
        <td>기프티콘 상세정보</td>
        </tr>
        </thead>
        <tbody>
        <tr>
        <td>Starbucks_Americano</td>
        <td>스타벅스 아메리카노</td>
        <td>30 SKK</td>
        <td>10</td>
        <td><button id="giftdetaillookup1">목록 조회</button></td>
        </tr>
        <tr>
        <td>GS25_BananaMilk</td>
        <td>GS25 바나나우유</td>
        <td>15 SKK</td>
        <td>50</td>
        <td><button id="giftdetaillookup2">목록 조회</button></td>
        </tr>
        </tbody>
        </table>
        </p>
        <hr/>
        <p id="add">
        <h2>기프티콘 추가</h2>
        <form id="addform" method="POST">
        <table>
        <thead>
        <tr>
        <td>Type</td>
        <td>이름</td>
        <td>이미지</td>
        </tr>
        </thead>
        <tbody>
        <tr>
        <td>
        <input type="text" id="gifttype" class="gifttype" placeholder="Type" />
        </td>
        <td>
        <input type="text" id="giftname" class="giftname" placeholder="Name" />
        </td>
        <td>
        <input type="file" id="files" class="files" name="img" onchange="addItem(this);" accept="image/*" multiple />
        <p id="images"></p>
        </td>
        </tr>
        </tbody>
        </table>
        <p>
        <button id="addGift" onclick="sendItem()">추가</button>
        </p>
        </form>
        </p>
        `);
    }

    function loadUserContent() {
      $("#loadUser").prop('disabled', true).toggleClass("disabled");
      $("#loadGifticon").prop('disabled', false).toggleClass("disabled");
      $("div").html(`
        <p>
        <h2>사용자 목록</h2>
        <table border=0 cellspacing=0 id=\"users\">
        <thead>
        <tr>
        <td>이름</td>
        <td>학번</td>
        <td>토큰 지급</td>
        <tr>
        </thead>
        <tbody>
        </tbody>
        </table>
        <button>조회</button>
        </p>`);
    }
  </script>

  <style>
    * {
      color: #24292e;
      font-size: 16px;
      line-height: 1.5
    }

    .disabled {
      color: #999
    }

    h2 {
      font-size: 30px;
    }

    table {
      border-collapse: collapse;
      border-spacing: 0;
    }

    table th,
    table td {
      border: 1px solid #dfe2e5;
      padding: 6px 13px;
      text-align: center;
    }

    table tr {
      background-color: #fff;
      border-top: 1px solid #c6cbd1
    }

    table tbody tr:nth-child(even) {
      background-color: #f6f8fa;
    }
  </style>
</head>

<body>
  <button id="loadGifticon" onclick="loadGifticonContent()">기프티콘 관리</button><button id="loadUser" onclick="loadUserContent()" class="disabled">사용자 관리</button>
  <hr />
  무언가 찾고자 할 때에는 Ctrl+F를 이용하는 것이 편리합니다.
  <div>
  </div>
</body>

</html>
